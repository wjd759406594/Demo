<!DOCTYPE html><html><head><meta charset="utf-8"/><meta name="format-detection" content="telephone=no"/><meta name="msapplication-tap-highlight" content="no"/><meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1"/><link rel="stylesheet" type="text/css" href="../css/framework7.css"/><link rel="stylesheet" type="text/css" href="../css/iconfont.css"/><link rel="stylesheet" type="text/css" href="../css/common.css"/><title>快捷开单</title></head><body><div class="statusbar-overlay"></div><div class="panel-overlay"></div><div class="views toolbar-fixed" id="fastKpPage"><div class="view view-main"><div class="pages navbar-fixed"><div data-page="createSheet" class="page no-tabbar" id="tab2"><div class="navbar"><div class="navbar-inner"><div class="left sliding"><a href="#" class="back link"><i class="icon icon-back"></i></a></div><div class="center">快捷开单</div><div class="right"><a href="#" class="link" @click="crateNew()"><span>新建</span></a></div></div></div><div class="page-content"><validator name="validation1"><form novalidate><template v-if="!showCreate"><div class="content-block-title"><i class="icon icon-message"></i>提取预填单</div><div class="list-block"><ul><li><div class="item-content"><div class="item-inner"><div class="item-title label">客户电话</div><div class="item-input item-input-field"><input type="number" placeholder="微信登录的手机号"v-model="prePhone"><a href="#"@click="findPreSheet(prePhone)"class="btn"><i class="iconfont icon-search"></i></a></div></div></div></li></ul></div></template><div class="content-block-title"><i class="icon icon-message"></i>网点信息</div><div class="list-block"><ul><li><div class="item-content"><div class="item-inner"><div class="item-title label">发货区域</div><div class="item-input item-input-field"><input type="text" placeholder="发货区域"v-model="fromAreaName"v-validate:fromAreaName="{required: {rule: true, message: '请输入发货区域' }}"><template v-if="!showCreate"><a href="#"@click="searchFromOrgArea(fromAreaName)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">最终目的地</div><div class="item-input item-input-field"><input type="text" placeholder="最终目的地"v-model="toAreaName"v-validate:toAreaName="{required: {rule: true, message: '请选择最终目的地' }}"><template v-if="!showCreate"><a href="#"@click="searchToOrgArea(toAreaName)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">到货网点</div><div class="item-input"><input type="text" placeholder="自动关联(不可录入)"v-model="toShopName" disabled="disabled"v-validate:toShopName="{required: {rule: true, message: '到货网点不能为空' }}"></div></div></div></li></ul></div><div class="content-block-title"><i class="icon icon-message"></i>发货客户</div><div class="list-block"><ul><li><div class="item-content"><div class="item-inner"><div class="item-title label">发货电话</div><div class="item-input item-input-field"><input type="number" placeholder="发货电话"v-model="fromCustomerPhone"id="fromCustomerPhone"v-validate:fromCustomerPhone="{required: {rule: true, message: '发货客户电话' },max: {rule: 99999999999, message: '电话号码最多11位' }}"><template v-if="!showCreate"><a href="#"@click="searchFromCustomer('发货电话','phone',fromCustomerPhone)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">发货客户</div><div class="item-input item-input-field"><input type="text" placeholder="发货客户"v-model="fromCustomerName"maxlength="8"v-validate:fromCustomerName="{required: {rule: true, message: '发货客户名' }}"><template v-if="!showCreate"><a href="#"@click="searchFromCustomer('发货客户','name',fromCustomerName)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">开户行</div><div class="item-input item-input-field"><select  id="fromCustomerBank" name="fromCustomerBank" v-model="fromCustomerBank"><option value="" selected>请选择开户行</option></select></div></div></div></li><template v-if="fromCustomerBank !=''"><li><div class="item-content"><div class="item-inner"><div class="item-title label">开户名</div><div class="item-input item-input-field"><input type="text" placeholder="开户名"v-model="fromCustomerHolder"v-validate:fromCustomerHolder="{required: {rule: true, message: '开户名' }}"></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">银行卡号</div><div class="item-input item-input-field"><input type="number" placeholder="银行卡号"v-model="fromCustomerAccount"v-validate:fromCustomerAccount="{required: {rule: true, message: '银行卡号' }}"></div></div></div></li></template></ul></div><div class="content-block-title"><i class="icon icon-message"></i>收货客户</div><div class="list-block"><ul><li><div class="item-content"><div class="item-inner"><div class="item-title label">收货电话</div><div class="item-input item-input-field"><input type="number" placeholder="收货电话"maxlength="15"v-model="toCustomerPhone"v-validate:toCustomerPhone="{required: {rule: true, message: '收货客户电话' },max: {rule: 99999999999, message: '电话号码最多11位' }}"><template v-if="!showCreate"><a href="#"@click="searchToCustomer('收货电话','phone',toCustomerPhone)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">收货客户</div><div class="item-input item-input-field"><input type="text" placeholder="收货客户"maxlength="8"v-model="toCustomerName"v-validate:toCustomerName="{required: {rule: true, message: '收货客户姓名' }}"><template v-if="!showCreate"><a href="#"@click="searchToCustomer('收货客户','name',toCustomerName)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><template v-if="template.toCustomerPhone1.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">备用电话</div><div class="item-input item-input-field"><input type="number" placeholder="收货备用电话"maxlength="15"v-model="toCustomerPhone1"></div></div></div></li></template><template v-if="template.toCustomerAddress.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">收货地址</div><div class="item-input item-input-field"><input type="text" placeholder="收货地址"v-model="toCustomerAddress"></div></div></div></li></template><li><div class="item-content"><div class="item-inner"><div class="item-title label">送货上门</div><div class="item-input item-input-field"><input type="checkbox" v-model="deliveryMode"v-bind:true-value="2"v-bind:false-value="1"></div></div></div></li></ul></div><div class="content-block-title"><i class="icon icon-message"></i>货物信息</div><div class="list-block"><ul><li><div class="item-content"><div class="item-inner"><div class="item-title label">货物名称</div><div class="item-input item-input-field"><input type="text" placeholder="货物名称" id="goodsName"v-validate:goodsName="{required: {rule: true, message: '货物名称' }}"v-model="goodsName"></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">件数</div><div class="item-input item-input-field"><input type="number" placeholder="件数"v-model="goodsAmount"v-validate:goodsAmount="{max: {rule: 10000, message: '货物件数太大了' },min: {rule: 1, message: '没有货物件数了' }}"id="goodsAmount"></div></div></div></li><template v-if="template.goodsPackage.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">包装</div><div class="item-input item-input-field"><select v-model="goodsPackage"><option value="无">无</option><option value="纸">纸</option><option value="木">木</option><option value="编">编</option><option value="桶">桶</option><option value="膜">膜</option><option value="托盘">托盘</option></select></div></div></div></li></template><template v-if="template.goodsWeight.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">重量</div><div class="item-input item-input-field"><input type="number" placeholder="重量(kg)"v-validate:goodsWeight="{max: {rule: 50000, message: '货物重量超过50吨了' }}"v-model="goodsWeight"></div></div></div></li></template><template v-if="template.goodsVolume.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">体积</div><div class="item-input item-input-field"><input type="number" placeholder="体积(m³)"v-validate:goodsVolume="{max: {rule: 100, message: '货物体积太大了' }}"v-model="goodsVolume"></div></div></div></li></template><template v-if="template.requirement.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">特殊需求</div><div class="item-input item-input-field"><select v-model="requirement"><option value="" selected>请选择</option><option value="加急">加急</option><option value="贵重">贵重</option><option value="易碎">易碎</option></select></div></div></div></li></template></ul></div><div class="content-block-title"><i class="icon icon-message"></i>费用信息</div><div class="list-block"><ul><li><div class="item-content bg-info"><div class="item-inner"><div class="item-title label">现付金额</div><div class="item-input item-input-field"><input type="number" placeholder="现付金额"v-validate:nowPayFee="{max: {rule: 1000000, message: '现付金额超过100w了' }}"v-model="nowPayFee"></div></div></div></li><li><div class="item-content bg-warning"><div class="item-inner"><div class="item-title label">提付金额</div><div class="item-input item-input-field"><input type="number" placeholder="提付金额"v-validate:pickPayFee="{max: {rule: 1000000, message: '提付金额超过100w了' }}"v-model="pickPayFee"></div></div></div></li><template v-if="template.backPayFee.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">回单付</div><div class="item-input item-input-field"><input type="number" placeholder="回单付"v-validate:backPayFee="{max: {rule: 1000000, message: '回单付金额超过100w了' }}"v-model="backPayFee"></div></div></div></li></template><li><div class="item-content"><div class="item-inner"><div class="item-title label">货款扣</div><div class="item-input item-input-field"><input type="number" placeholder="货款扣"v-validate:codPayFee="{max: {rule: 1000000, message: '货款扣金额超过100w了' }}"v-model="codPayFee"></div></div></div></li><li><div class="item-content"><div class="item-inner"><div class="item-title label">月结编号</div><div class="item-input item-input-field"><input type="number" placeholder="月结编号"maxlength="20"v-model="agreementNo"><template v-if="!showCreate"><a href="#"@click="searchAgreement(agreementNo)"class="btn"><i class="iconfont icon-search"></i></a></template></div></div></div></li><template v-if="agreementId > 0"><li><div class="item-content bg-light-blue"><div class="item-inner"><div class="item-title label">发货月结</div><div class="item-input item-input-field"><input type="number" placeholder="发货月结金额"v-validate:fromCustomerMonthFee="{max: {rule: 1000000, message: '发货月结金额超过100w了' }}"v-model="fromCustomerMonthFee"></div></div></div></li><li><div class="item-content bg-light-orange"><div class="item-inner"><div class="item-title label">收货月结</div><div class="item-input"><input type="number" placeholder="收货月结金额"v-validate:toCustomerMonthFee="{max: {rule: 1000000, message: '提货月结金额超过100w了' }}"v-model="toCustomerMonthFee"></div></div></div></li></template><template v-if="template.deliveryFee.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">送货费</div><div class="item-input item-input-field"><input type="number" placeholder="送货费"v-validate:deliveryFee="{max: {rule: 100000, message: '送货费超过10w了' }}"v-model="deliveryFee"></div></div></div></li></template><template v-if="template.rebates.show"><li><div class="item-content bg-green"><div class="item-inner"><div class="item-title label">劳务费</div><div class="item-input item-input-field"><input type="number" placeholder="劳务费"v-validate:rebates="{max: {rule: 100000, message: '劳务费金额超过10w了' }}"v-model="rebates"></div></div></div></li></template><template v-if="template.receiptFee.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">接货费</div><div class="item-input item-input-field"><input type="number" placeholder="接货费"v-validate:receiptFee="{max: {rule: 100000, message: '接货费超过10w了' }}"v-model="receiptFee"></div></div></div></li></template><template v-if="template.declaredValue.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">声明价值</div><div class="item-input item-input-field"><input type="number" placeholder="声明价值"v-validate:declaredValue="{max: {rule: 10000000, message: '声明价值超过1000w了' }}"v-model="declaredValue"></div></div></div></li></template><template v-if="template.premium.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">保费</div><div class="item-input item-input-field"><input type="number" placeholder="保费"v-validate:premium="{max: {rule: 100000, message: '保费金额超过10w了' }}"v-model="premium"></div></div></div></li></template><template v-if="fromCustomerCodCardNo >0 "><li><div class="item-content"><div class="item-inner"><div class="item-title label color-red">代收货款</div><div class="item-input item-input-field"><input type="number" placeholder="代收货款"v-validate:cod="{required: {rule: true, message: '有中原卡号,代收货款必填' },max: {rule: 1000000, message: '代收货款金额超过100w了' }}"v-model="cod"></div></div></div></li></template><template v-if="!fromCustomerCodCardNo || fromCustomerCodCardNo ==''"><li><div class="item-content"><div class="item-inner"><div class="item-title label color-red">代收货款</div><div class="item-input item-input-field"><input type="number" placeholder="代收货款"v-validate:cod="{max: {rule: 1000000, message: '代收货款金额超过100w了' }}"v-model="cod"></div></div></div></li></template></ul></div><div class="content-block-title"><i class="icon icon-message"></i>其他信息</div><div class="list-block"><ul><template v-if="template.backSheetAmount.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">回单张数</div><div class="item-input item-input-field"><input type="number" placeholder="回单张数"v-validate:backSheetAmount="{max: {rule: 100, message: '回单张数多于100张' }}"v-model="backSheetAmount"></div></div></div></li></template><template v-if="template.backSheetFee.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">回单费</div><div class="item-input item-input-field"><input type="number" placeholder="回单费"v-validate:backSheetFee="{max: {rule: 1000000, message: '回单费金额超过100w了' }}"v-model="backSheetFee"></div></div></div></li></template><template v-if="template.backSheetRequirement.show"><li><div class="item-content"><div class="item-inner"><div class="item-title label">回单要求</div><div class="item-input item-input-field"><input type="text" placeholder="回单要求"v-model="backSheetRequirement"></div></div></div></li></template><li><div class="item-content"><div class="item-inner"><div class="item-title label">备注</div><div class="item-input item-input-field"><input type="text" placeholder="备注"v-model="remarks"></div></div></div></li></ul></div><template v-if="!showCreate"><div class="list-block p10 list-btn"><ul><li><a href="#" class="item-link list-button btn"@click="submit($validation1)">创建运单</a></li></ul></div></template><template v-if="showCreate"><div class="list-block p10 list-btn"><ul><li><a href="#" class="item-link list-button btn bg-orange"@click="showDetail()">查看运单</a></li><li><div class="btn-groups"><a href="#" class="item-link list-button btn"@click="print('WaybillBh',3)">打印回单</a><a href="#"class="item-link list-button btn btn-orange"@click="print('WaybillBh',1)">打印标签</a><a href="#" class="item-link list-button btn btn-red"@click="print('WaybillBq',2)">打印运单</a></div></li></ul></div></template></form></validator></div></div><div data-page="findPreSheet" class="page no-tabbar cached" id="findPreSheetPage"><div class="navbar"><div class="navbar-inner"><div class="left sliding"><a href="#" class="back link"><i class="icon icon-back"></i></a></div><div class="center">选择预开单</div><div class="right"></div></div></div><div class="page-content"><div class="list-block media-list list-block-search searchbar-found"><ul></ul></div></div></div></div></div></div><script id="toAreaTmpl" type="text/template7">{{#toOrgAreas}}<li><a href="#" class="item-link" data-val='{{json this}}'><div class="item-content"><div class="item-inner"><div class="item-title">目的地:{{areaName}} 到货网点:{{orgName}}</div><div class="mdd hide">{{json this}}</div></div></div></a></li>{{/toOrgAreas}}</script><script id="findFromShopTmpl" type="text/template7">{{#toOrgAreas}}<li><a href="#" class="item-link" data-val='{{json this}}'><div class="item-content"><div class="item-inner"><div class="item-title">{{orgName}}{{name}}</div><div class="mdd hide">{{json this}}</div></div></div></a></li>{{/toOrgAreas}}</script><script id="findFromCustomerTmpl" type="text/template7">{{#toOrgAreas}}<li><a href="#" class="item-link" data-val='{{json this}}'><div class="item-content"><div class="item-inner"><div class="item-title">{{name}}-{{phone}}</div><div class="mdd hide">{{json this}}</div></div></div></a></li>{{/toOrgAreas}}</script><script id="preSheetTmpl" type="text/template7">{{#sheets}}<li><a href="#" class="item-link show-detail" data-val='{{json this}}'><div class="item-content"><div class="item-inner"><div class="item-title">{{attributes.goodsName}}({{attributes.goodsAmount}})</div><div class="item-subtitle">目的地:{{attributes.toAreaName}}</div><div class="item-subtitle">收货:{{attributes.toCustomerName}}{{attributes.toCustomerPhone}}</div><div class="item-subtitle">时间:{{updatedAt}}</div></div></div></a></li>{{/sheets}}</script><script src="../js/libs/jquery.min.js"></script><script src="../js/libs/parse.js"></script><script src="../js/libs/framework7.js"></script><script src="../js/libs/vue.js"></script><script src="../js/libs/vue-validator.min.js"></script><script src="../js/sea.js"></script><script src="../js/main.js"></script><script>seajs.use("js/modules/views/createSheet",function(){console.log("启动应用")});</script></body></html>